<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>–û–ø—Ä–æ—Å–Ω–∏–∫ –î. –û–ª–≤–µ—É—Å–∞</title>
<style>
  body {
    font-family: Arial, sans-serif;
    max-width: 800px;
    margin: 20px auto;
    background: #f8f9fa;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
  }
  h2 { text-align: center; }
  .question {
    margin-bottom: 15px;
    background: white;
    padding: 10px 15px;
    border-radius: 8px;
    border: 1px solid #ddd;
  }
  #text {
    text-align: center;
  }
  label { display: block; margin: 5px 0; }
  button {
    display: block;
    margin: 20px auto;
    padding: 10px 25px;
    font-size: 16px;
    background-color: #007BFF;
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
  }
  button:hover { background-color: #0056b3; }
  .info-block {
    display: flex;
    gap: 15px;
    flex-wrap: wrap;
    margin-bottom: 20px;
  }
  .info-block label { font-weight: bold; }
  .info-block input, .info-block select {
    padding: 5px;
    border-radius: 5px;
    border: 1px solid #ccc;
  }
</style>
</head>
<body>

<h2>–û–ø—Ä–æ—Å–Ω–∏–∫ –î. –û–ª–≤–µ—É—Å–∞</h2>
<p id="text">–£–≤–∞–∂–∞–µ–º—ã–µ —Å—Ç—É–¥–µ–Ω—Ç—ã!<br>
–ü—Ä–æ—Å–∏–º –≤–∞—Å –æ—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã —á–µ—Å—Ç–Ω–æ. –ê–Ω–∫–µ—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∞–Ω–æ–Ω–∏–º–Ω–æ–µ.<br>
–û—Ç–º–µ—Ç—å—Ç–µ, –∫–∞–∫ —á–∞—Å—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ —É–∫–∞–∑–∞–Ω–Ω–æ–µ —Å –≤–∞–º–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–µ—Å—è—Ü.<br>
–í–∞—à–∏ –æ—Ç–≤–µ—Ç—ã –ø–æ–º–æ–≥—É—Ç –ø–æ–Ω—è—Ç—å, –Ω–∞—Å–∫–æ–ª—å–∫–æ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω—ã –ø—Ä–æ—è–≤–ª–µ–Ω–∏—è –∞–≥—Ä–µ—Å—Å–∏–∏ –∏ –≤–∏–∫—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –≤ —Å—Ç—É–¥–µ–Ω—á–µ—Å–∫–æ–π —Å—Ä–µ–¥–µ.
</p>

<div class="info-block">
  <div>
    <label for="group">–ì—Ä—É–ø–ø–∞:</label>
    <input type="text" id="group" placeholder="–£–∫–∞–∂–∏—Ç–µ —Å–≤–æ—é –≥—Ä—É–ø–ø—É" required>
  </div>
  <div>
    <label for="age">–í–æ–∑—Ä–∞—Å—Ç:</label>
    <input type="number" id="age" min="5" max="30" placeholder="–í–æ–∑—Ä–∞—Å—Ç" required>
  </div>
  <div>
    <label for="gender">–ü–æ–ª:</label>
    <select id="gender" required>
      <option value="">–í—ã–±–µ—Ä–∏—Ç–µ...</option>
      <option value="–ú—É–∂—Å–∫–æ–π">–ú—É–∂—Å–∫–æ–π</option>
      <option value="–ñ–µ–Ω—Å–∫–∏–π">–ñ–µ–Ω—Å–∫–∏–π</option>
    </select>
  </div>
</div>

<form id="quizForm">
  <div id="questions"></div>
  <button type="button" onclick="calculateResult()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç</button>
</form>

<script>
const questions = [
  "–Ø –∫–æ–≥–æ-—Ç–æ –æ–±–æ–∑–≤–∞–ª.",
  "–Ø —Å –∫–µ–º-—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –Ω–µ —Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–ª.",
  "–Ø –Ω–∞–Ω–µ—Å –∫–æ–º—É-—Ç–æ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π –≤—Ä–µ–¥, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–æ–ª–∫–Ω—É–ª –∏–ª–∏ —É–¥–∞—Ä–∏–ª.",
  "–Ø —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–ª –æ –∫–æ–º-—Ç–æ —Å–ø–ª–µ—Ç–Ω–∏.",
  "–Ø —É–≥—Ä–æ–∂–∞–ª.",
  "–Ø —É–∫—Ä–∞–ª –∏–ª–∏ –∏—Å–ø–æ—Ä—Ç–∏–ª —á—å–∏-—Ç–æ –≤–µ—â–∏.",
  "–ú–µ–Ω—è –æ–±–∑—ã–≤–∞–ª–∏.",
  "–û–±–æ –º–Ω–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è–ª–∏ —Å–ø–ª–µ—Ç–Ω–∏.",
  "–ù–∏–∫—Ç–æ –Ω–µ —Ö–æ—á–µ—Ç —Å–∏–¥–µ—Ç—å —Å–æ –º–Ω–æ–π –∏–ª–∏ –ø—Ä–æ–≤–æ–¥–∏—Ç—å —Å–≤–æ–±–æ–¥–Ω–æ–µ –≤—Ä–µ–º—è.",
  "–£ –º–µ–Ω—è —É–∫—Ä–∞–ª–∏ –≤–µ—â–∏.",
  "–ú–Ω–µ –Ω–∞–Ω–µ—Å–ª–∏ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–π –≤—Ä–µ–¥ (—É–¥–∞—Ä–∏–ª–∏, —Ç–æ–ª–∫–Ω—É–ª–∏).",
  "–ù–∏–∫—Ç–æ –Ω–µ —Ä–∞–∑–≥–æ–≤–∞—Ä–∏–≤–∞–µ—Ç —Å–æ –º–Ω–æ–π.",
  "–ú–Ω–µ —É–≥—Ä–æ–∂–∞–ª–∏."
];

const answerOptions = [
  "–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –±—ã–ª–æ",
  "–ë—ã–ª–æ —Ä–∞–∑ –∏–ª–∏ –¥–≤–∞",
  "–ë—ã–≤–∞–µ—Ç –∏–Ω–æ–≥–¥–∞",
  "–ë—ã–≤–∞–µ—Ç —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é",
  "–ë—ã–≤–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é"
];

const activeRange = [0,1,2,3,4,5];
const passiveRange = [6,7,8,9,10,11,12];

window.onload = function() {
  const container = document.getElementById("questions");
  questions.forEach((q, i) => {
    const div = document.createElement("div");
    div.className = "question";
    div.innerHTML = `<strong>${i+1}. ${q}</strong>`;
    answerOptions.forEach((opt, idx) => {
      div.innerHTML += `
        <label>
          <input type="radio" name="q${i}" value="${idx}" required> ${opt}
        </label>`;
    });
    container.appendChild(div);
  });
};

function interpretNumeric(value) {
  if (value < 1) return "—Å–ª–∞–±–æ –≤—ã—Ä–∞–∂–µ–Ω–æ";
  if (value < 2.5) return "—É–º–µ—Ä–µ–Ω–Ω–æ –≤—ã—Ä–∞–∂–µ–Ω–æ";
  return "—è—Ä–∫–æ –≤—ã—Ä–∞–∂–µ–Ω–æ (—Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –ø—Ä–æ—è–≤–ª–µ–Ω–∏–µ)";
}

async function calculateResult() {
  const group = document.getElementById("group").value.trim();
  const age = document.getElementById("age").value.trim();
  const gender = document.getElementById("gender").value;

  let activeSum = 0, passiveSum = 0;
  let activeCount = 0, passiveCount = 0;

  for (let i = 0; i < questions.length; i++) {
    const selected = document.querySelector(`input[name="q${i}"]:checked`);
    if (!selected) {
      alert("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ—Ç–≤–µ—Ç—å—Ç–µ –Ω–∞ –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã!");
      return;
    }
    const value = parseInt(selected.value);
    if (activeRange.includes(i)) { activeSum += value; activeCount++; }
    if (passiveRange.includes(i)) { passiveSum += value; passiveCount++; }
  }

  const activeAvg = parseFloat((activeSum / activeCount).toFixed(2));
  const passiveAvg = parseFloat((passiveSum / passiveCount).toFixed(2));

  const activeText = interpretNumeric(activeAvg);
  const passiveText = interpretNumeric(passiveAvg);

  const data = {
    group,
    age,
    gender,
    activeScore: `${activeAvg} ‚Äî ${activeText}`,
    passiveScore: `${passiveAvg} ‚Äî ${passiveText}`
  };

  await sendToGoogleSheets(data);

  // –û—á–∏—Å—Ç–∏—Ç—å —Ñ–æ—Ä–º—É –∏ –ø–µ—Ä–µ–∫–∏–Ω—É—Ç—å
  document.getElementById("quizForm").reset();
  document.body.innerHTML = `
    <h2>–°–ø–∞—Å–∏–±–æ –∑–∞ —É—á–∞—Å—Ç–∏–µ!</h2>
    <p>–í–∞—à–∏ –æ—Ç–≤–µ—Ç –ø—Ä–∏–Ω—è—Ç.</p>
  `;
}

async function sendToGoogleSheets(data) {
  const scriptURL = "https://script.google.com/macros/s/AKfycbxxRb091epJ0bPoYbNbcYOJxRqKKU9PSf8ZPuTB3a0qjd_6LOkpVpA1MNQ461YL-10O/exec";
  try {
    await fetch(scriptURL, {
      method: "POST",
      mode: "no-cors",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data)
    });
  } catch (error) {
    alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –¥–∞–Ω–Ω—ã—Ö: " + error.message);
  }
}

// üîí –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ F12 –∏ –∏–Ω—Å–ø–µ–∫—Ç–æ—Ä–∞
document.onkeydown = function(e) {
  if (e.keyCode == 123 || // F12
      (e.ctrlKey && e.shiftKey && (e.keyCode == 'I'.charCodeAt(0) ||
                                   e.keyCode == 'J'.charCodeAt(0))) ||
      (e.ctrlKey && e.keyCode == 'U'.charCodeAt(0))) {
    e.preventDefault();
    return false;
  }
};
</script>
</body>
</html>

