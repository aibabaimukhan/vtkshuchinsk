<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Опросник Д. Олвеуса</title>
<style>
  body {
    font-family: Arial, sans-serif;
    max-width: 800px;
    margin: 20px auto;
    background: #f8f9fa;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
  }
  h2 { text-align: center; }
  .question {
    margin-bottom: 15px;
    background: white;
    padding: 10px 15px;
    border-radius: 8px;
    border: 1px solid #ddd;
  }
  #text {
    text-align: center;
  }
  label { display: block; margin: 5px 0; }
  button {
    display: block;
    margin: 20px auto;
    padding: 10px 25px;
    font-size: 16px;
    background-color: #007BFF;
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
  }
  button:hover { background-color: #0056b3; }
  #result {
    display: none;
    background: #e9ecef;
    padding: 15px;
    border-radius: 8px;
    margin-top: 20px;
  }
  .info-block {
    display: flex;
    gap: 15px;
    flex-wrap: wrap;
    margin-bottom: 20px;
  }
  .info-block label {
    font-weight: bold;
  }
  .info-block input, .info-block select {
    padding: 5px;
    border-radius: 5px;
    border: 1px solid #ccc;
  }
  .small {
    font-size: 13px;
    color: #555;
    margin-top: 10px;
  }
</style>
</head>
<body>

<h2>Опросник Д. Олвеуса</h2>
<p id="text">Уважаемые студенты!<br>
Просим вас ответить на вопросы честно. Анкетирование анонимное.<br>
Отметьте, как часто происходило указанное с вами за последний месяц.<br>
Ваши ответы помогут понять, насколько распространены проявления агрессии и виктимизации в студенческой среде.
</p>

<div class="info-block">
  <div>
    <label for="group">Группа:</label>
    <input type="text" id="group" placeholder="Укажите свою группу" required>
  </div>
  <div>
    <label for="age">Возраст:</label>
    <input type="number" id="age" min="5" max="30" placeholder="Возраст" required>
  </div>
  <div>
    <label for="gender">Пол:</label>
    <select id="gender" required>
      <option value="">Выберите...</option>
      <option value="Мужской">Мужской</option>
      <option value="Женский">Женский</option>
    </select>
  </div>
</div>

<form id="quizForm">
  <div id="questions"></div>
  <button type="button" onclick="calculateResult()">Отправить результат</button>
</form>

<div id="result"></div>

<script>
const questions = [
  "Я кого-то обозвал.",
  "Я с кем-то специально не разговаривал.",
  "Я нанес кому-то физический вред, например, толкнул или ударил.",
  "Я распространял о ком-то сплетни.",
  "Я угрожал.",
  "Я украл или испортил чьи-то вещи.",
  "Меня обзывали.",
  "Обо мне распространяли сплетни.",
  "Никто не хочет сидеть со мной или проводить свободное время.",
  "У меня украли вещи.",
  "Мне нанесли физический вред (ударили, толкнули).",
  "Никто не разговаривает со мной.",
  "Мне угрожали."
];

const answerOptions = [
  "Никогда не было",
  "Было раз или два",
  "Бывает иногда",
  "Бывает раз в неделю",
  "Бывает несколько раз в неделю"
];

// Активный буллинг: 1–6
// Пассивная виктимизация: 7–13
const activeRange = [0,1,2,3,4,5];
const passiveRange = [6,7,8,9,10,11,12];

window.onload = function() {
  const container = document.getElementById("questions");
  questions.forEach((q, i) => {
    const div = document.createElement("div");
    div.className = "question";
    div.innerHTML = `<strong>${i+1}. ${q}</strong>`;
    answerOptions.forEach((opt, idx) => {
      div.innerHTML += `
        <label>
          <input type="radio" name="q${i}" value="${idx}" required> ${opt}
        </label>`;
    });
    container.appendChild(div);
  });
};

function interpretNumeric(value) {
    if (value < 1) return "слабо выражено";
    if (value < 2.5) return "умеренно выражено";
    return "ярко выражено (регулярное проявление)";
  }

  async function calculateResult() {
    const group = document.getElementById("group").value.trim();
    const age = document.getElementById("age").value.trim();
    const gender = document.getElementById("gender").value;

    let activeSum = 0, passiveSum = 0;
    let activeCount = 0, passiveCount = 0;

    for (let i = 0; i < questions.length; i++) {
      const selected = document.querySelector(`input[name="q${i}"]:checked`);
      if (!selected) {
        alert("Пожалуйста, ответьте на все вопросы!");
        return;
      }
      const value = parseInt(selected.value);
      if (activeRange.includes(i)) { activeSum += value; activeCount++; }
      if (passiveRange.includes(i)) { passiveSum += value; passiveCount++; }
    }

    const activeAvg = parseFloat((activeSum / activeCount).toFixed(2));
    const passiveAvg = parseFloat((passiveSum / passiveCount).toFixed(2));

    const activeText = interpretNumeric(activeAvg);
    const passiveText = interpretNumeric(passiveAvg);

    const resultDiv = document.getElementById("result");
    resultDiv.style.display = "block";
    resultDiv.innerHTML = `
      <h3>Результаты</h3>
      <p><strong>Группа:</strong> ${group || "—"} | <strong>Возраст:</strong> ${age || "—"} | <strong>Пол:</strong> ${gender || "—"}</p>
      <p><strong>Активный буллинг:</strong> средний балл ${activeAvg} — ${activeText}</p>
      <p><strong>Пассивная виктимизация:</strong> средний балл ${passiveAvg} — ${passiveText}</p>
      <div class="small">
        <p>Пояснение по шкале: 0–1 — слабо выражено; около 2 — умеренно выражено; 3–4 — ярко выражено (регулярное проявление).</p>
      </div>
    `;

    const data = {
      group,
      age,
      gender,
      activeScore: `${activeAvg} — ${activeText}`,
      passiveScore: `${passiveAvg} — ${passiveText}`
    };

    await sendToGoogleSheets(data);
  }

  async function sendToGoogleSheets(data) {
    const scriptURL = "https://script.google.com/macros/s/AKfycbxxRb091epJ0bPoYbNbcYOJxRqKKU9PSf8ZPuTB3a0qjd_6LOkpVpA1MNQ461YL-10O/exec";
    try {
      await fetch(scriptURL, {
        method: "POST",
        mode: "no-cors",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
      });
      alert("Результаты успешно отправлены в таблицу!");
    } catch (error) {
      alert("Ошибка при отправке данных: " + error.message);
    }
  }
</script>

</body>
</html>







